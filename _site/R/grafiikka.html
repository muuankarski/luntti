<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Grafiikka</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- change the folder below to switch themes -->
    <link rel="stylesheet" href="/css/lumen/bootstrap.css" media="screen">
    <link rel="stylesheet" href="/css/assets/css/bootswatch.min.css"> 


<!-- to quickly try out themes, activate this and tweak the url!
    <link rel="stylesheet" href="./bootstrap.css" media="screen">
-->

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/footer.css">

        <!-- Font avesome -->
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">


  </head>
  <body>
    <script src="http://bootswatch.com/assets/js/bsa.js"></script>

    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a href="" class="navbar-brand">Etusivu</a>
          <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div class="navbar-collapse collapse" id="navbar-main">
          <ul class="nav navbar-nav">
                <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="themes">R<span class="caret"></span></a>
              <ul class="dropdown-menu" aria-labelledby="R">
                <li><a href="/R/lue.html">Datan lukeminen & kirjoittaminen</a></li>
                <li><a href="/R/manipulointi.html">Manipuloiminen</a></li>
                <li><a href="/R/funktiot.html">Funktiot</a></li>
                <li><a href="/R/grafiikka.html">Grafiikka</a></li>
                <li><a href="/R/survey.html">Survey</a></li>
              </ul>         
         </ul>
         <ul class="nav navbar-nav">
                <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="themes">Toistettava tutkimus<span class="caret"></span></a>
              <ul class="dropdown-menu" aria-labelledby="toistettava">
                <li><a href="/toistettava/knitr.html">knitr</a></li>
                <li><a href="/toistettava/kirjoita.html">Kirjoittaminen</a></li>
              </ul>         
         </ul>
         <ul class="nav navbar-nav">
                <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="themes">Versiohallinta<span class="caret"></span></a>
              <ul class="dropdown-menu" aria-labelledby="versio">
                <li><a href="/versio/git.html">git</a></li>
              </ul>         
         </ul>
         <ul class="nav navbar-nav">
                <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="themes">Julkaiseminen<span class="caret"></span></a>
              <ul class="dropdown-menu" aria-labelledby="julkaisu">
                <li><a href="/julkaisu/latex.html">latex</a></li>
                <li><a href="/julkaisu/jekyll.html">jekyll</a></li>
                <li><a href="/julkaisu/pandoc.html">Pandoc</a></li>
              </ul>         
         </ul>



         <ul class="nav navbar-nav navbar-right">
<!--                        <li><a href="/feed.xml" title="Blog feed"><i class="fa fa-rss fa-2x"></i></a></li> -->
            <li><a href="http://markuskainu.fi" title="Markus Kainu"><i class="fa fa-thumbs-o-up fa-2x"></i></a></li>

            <li><a href="mailto:markuskainu@gmail.com?Subject=Lunttisivustosta!" title="Email!" target="_top"><i class="fa fa-envelope fa-2x"></i></a></li>                        

                      <!--  <li><a href="https://github.com/vaphana" title="Github"><i class="fa fa-github fa-2x"></i></a></li>
		        <li><a href="/index_en.html" title="In English"><i class="fa fa-language fa-2x"></i></a> -->
            </li>

                        
          </ul>
        </div>
      </div>
    </div>


    <div class="container">

          <h1 id="graphics-using-with-ggplot2">Graphics using with ggplot2</h1>

<h2 id="obtaining-the-data-and-defining-the-colors">Obtaining the data and defining the colors</h2>

<p><code>r
library(ggplot2)
library(laeken)
data(eusilc)
df &lt;- eusilc
head(df)
</code></p>

<p><code>
##   db030 hsize db040 rb030 age  rb090 pl030 pb220a py010n py050n py090n
## 1     1     3 Tyrol   101  34 female     2     AT   9756      0      0
## 2     1     3 Tyrol   102  39   male     1  Other  12472      0      0
## 3     1     3 Tyrol   103   2   male  &lt;NA&gt;   &lt;NA&gt;     NA     NA     NA
## 4     2     4 Tyrol   201  38 female     7     AT  12487      0      0
## 5     2     4 Tyrol   202  43   male     1     AT  42821      0      0
## 6     2     4 Tyrol   203  11   male  &lt;NA&gt;   &lt;NA&gt;     NA     NA     NA
##   py100n py110n py120n py130n py140n hy040n hy050n hy070n hy080n hy090n
## 1      0      0      0      0      0   4274   2428      0      0  33.39
## 2      0      0      0      0      0   4274   2428      0      0  33.39
## 3     NA     NA     NA     NA     NA   4274   2428      0      0  33.39
## 4      0      0      0      0      0      0   1550      0      0   2.13
## 5      0      0      0      0      0      0   1550      0      0   2.13
## 6     NA     NA     NA     NA     NA      0   1550      0      0   2.13
##   hy110n hy130n hy145n eqSS eqIncome db090 rb050
## 1      0      0      0  1.8    16091 504.6 504.6
## 2      0      0      0  1.8    16091 504.6 504.6
## 3      0      0      0  1.8    16091 504.6 504.6
## 4      0      0      0  2.1    27076 493.4 493.4
## 5      0      0      0  2.1    27076 493.4 493.4
## 6      0      0      0  2.1    27076 493.4 493.4
</code></p>

<p>```r
manual.color &lt;- scale_color_manual(values=c(“#CC79A7”,”#E69F00”,
                                       “#56B4E9”,”#000000”,
                                       “#009E73”,”#D55E00”,
                                       “#0072B2”,”#999999”,
                                       “#00FF00”,”Dim Grey”,
                                       “#56B4E9”,”#000000”,
                                       “#009E73”,”#D55E00”,
                                       “#0072B2”,”#999999”))</p>

<p>manual.fill &lt;- scale_fill_manual(values=c(“#CC79A7”,”#E69F00”,
                                       “#56B4E9”,”#000000”,
                                       “#009E73”,”#D55E00”,
                                       “#0072B2”,”#999999”,
                                       “#00FF00”,”Dim Grey”,
                                       “#56B4E9”,”#000000”,
                                       “#009E73”,”#D55E00”,
                                       “#0072B2”,”#999999”))
```</p>

<h2 id="bar-plot">Bar plot</h2>

<h3 id="proportions-of-female-and-male-headed-households-by-region">Proportions of female and male headed households by region</h3>

<p><code>r
library(ggplot2)
library(grid)
tbl &lt;- data.frame(prop.table(table(df$db040,df$rb090),1) * 100)
tbl$Freq &lt;- round(tbl$Freq, 1)
# ordering the levels of rdb040 by femla share
df.order &lt;- subset(tbl, Var2 == 'female')
df.order &lt;- df.order[order(df.order$Freq),]
tbl$Var1 &lt;- factor(tbl$Var1, levels = df.order$Var1)
  # bar plot
ggplot(tbl, aes(x=Var2,y=Freq,label=Freq,fill=Var1)) +
  geom_bar(position="dodge", stat="identity") +
  geom_text(position = position_dodge(width=1), vjust=-0.5, size=3) +
  labs(x="xlab",y="ylab") +
  labs(title="plot title") +
  theme(axis.text.x  = element_text(angle=90, vjust= 0.5)) +
  coord_cartesian(ylim=c(0,75)) + 
  annotate("text", x = 1.5, y = 65, label = "Some text here") +
  theme(legend.title=element_blank()) +
  theme(legend.key.size = unit(3, "mm")) +
  theme(legend.position="top") +
  manual.fill
</code></p>

<p><code>
## ymax not defined: adjusting position using y instead
</code></p>

<p><img src="figure/tolppa1.png" alt="plot of chunk tolppa1" /> </p>

<h2 id="line-plot">Line Plot</h2>

<p>```r
df &lt;- read.csv(“http://vincentarelbundock.github.com/Rdatasets/csv/Ecdat/Cigarette.csv”)
df$year &lt;- as.numeric(df$year)</p>

<p>cnames &lt;- subset(df, year == 1995)
ggplot(df, 
       aes(x=year,y=packpc,group=state,color=state)) +
  geom_line() + 
  geom_point() +
  scale_x_continuous(breaks=1985:1995) +
  geom_text(data=cnames, aes(x=year,y=packpc,label=state), 
            size=4, hjust=-0.2) +
  labs(x=”year”,y=”number of packs per capita”) +
  labs(title=”The Cigarette Consumption Panel Data Set”) +
  theme(legend.position=”none”)
```</p>

<p><img src="figure/viiva1.png" alt="plot of chunk viiva1" /> </p>

<h2 id="scatter-plots">Scatter plots</h2>

<h3 id="age-vs-household-income-by-region-and-sex">Age vs. household income by region and sex</h3>

<p><code>r
df &lt;- eusilc
# aggregate a table
tbl &lt;- aggregate(eqIncome~db040+rb090+age, 
                            median,
                            data=df)
# subset to cover ages 18-75
tbl &lt;- subset(tbl, age &gt; 17 &amp; age &lt; 76)
# plot
ggplot(tbl, aes(x=age,y=eqIncome,color=rb090)) +
  geom_point() + 
  facet_wrap(~db040) +
  geom_smooth(method=lm, se=TRUE) +
  labs(x="xlab",y="ylab") +
  labs(title="plot title") +
  theme(axis.text.x  = element_text(angle=90, vjust= 0.5)) +
  theme(legend.title=element_blank()) +
  theme(legend.key.size = unit(3, "mm")) +
  theme(legend.position="top") +
  manual.color
</code></p>

<p><img src="figure/hajonta1.png" alt="plot of chunk hajonta1" /> </p>

<h2 id="distributions-by-ageclass-region-and-gender">Distributions by ageclass, region and gender</h2>

<h3 id="as-a-density-plot">As a density plot</h3>

<p>```r
df &lt;- eusilc
df$age_class[df$age &lt; 18] &lt;- ‘0-17’
df$age_class[df$age &gt;= 18 &amp; df$age &lt; 25] &lt;- ‘18-24’
df$age_class[df$age &gt;= 25 &amp; df$age &lt; 55] &lt;- ‘26-54’
df$age_class[df$age &gt;= 55 &amp; df$age &lt; 65] &lt;- ‘55-64’
df$age_class[df$age &gt;= 65] &lt;- ‘65 &lt;’</p>

<p>ggplot(df, aes(x=eqIncome,fill=age_class)) +
  geom_density(alpha=.4) +
  facet_grid(rb090~db040) +
  labs(x=”xlab”,y=”ylab”) +
  labs(title=”plot title”) +
  theme(axis.text.x  = element_text(angle=90, vjust= 0.5)) +
  theme(legend.title=element_blank()) +
  theme(legend.key.size = unit(3, “mm”)) +
  theme(legend.position=”top”) +
  coord_cartesian(xlim=c(0,30000)) +
  manual.fill
```</p>

<p><img src="figure/silc1.png" alt="plot of chunk silc1" /> </p>

<h3 id="as-a-box-plot">As a box plot</h3>

<p><code>r
ggplot(df, aes(x=age_class,y=eqIncome, fill=rb090)) +
  geom_boxplot() +
  facet_wrap(~db040) +
  labs(x="xlab",y="ylab") +
  labs(title="plot title") +
  theme(axis.text.x  = element_text(angle=90, vjust= 0.5)) +
  theme(legend.title=element_blank()) +
  theme(legend.key.size = unit(3, "mm")) +
  theme(legend.position="top") +
  coord_cartesian(ylim=c(0,30000)) +
  manual.fill
</code></p>

<p><img src="figure/silc2.png" alt="plot of chunk silc2" /> </p>



      <footer>

        <div class="row">
          <div class="col-lg-12">

            <ul class="list-unstyled">
              <li class="pull-right"><a href="#top">Back to top</a></li>     
            </ul>

<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons -käyttölupa" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br />Tämä teos on lisensoitu <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Nimeä 4.0 Kansainvälinen -käyttöluvalla</a>.



            

            <p>Theme by <a href="http://thomaspark.me" rel="nofollow">Thomas Park</a>
            <p>Code released under the <a href="https://github.com/thomaspark/bootswatch/blob/gh-pages/LICENSE">MIT License</a>.</p>
            <p>Based on <a href="http://getbootstrap.com" rel="nofollow">Bootstrap</a>. Icons from <a href="http://fortawesome.github.io/Font-Awesome/" rel="nofollow">Font Awesome</a>. Web fonts from <a href="http://www.google.com/webfonts" rel="nofollow">Google</a>.</p>

        </div>

<!--
<blockquote class="pull-left">
  <p>Give a man a fish and you feed him for a day; teach a man to fish and you feed him for a lifetime</p>
  <small>Anne Isabella Thackeray Ritchie <cite title="Source Title">Mrs. Dymond (1885)</cite></small>
</blockquote>
-->
      </footer>


    </div>


    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="http://bootswatch.com/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="http://bootswatch.com/assets/js/bootswatch.js"></script>
  </body>
</html>


